---
classes:
  - 'clamav'
  - 'google_credentials'
  - 'nginx::server'
  - 'performanceplatform::nodejs'
  - 'performanceplatform::mongo'
  - 'phantomjs'
  - 'python'
  - 'varnish'

performanceplatform::dns::hosts: |
  127.0.0.1 jumpbox-1 monitoring log graphite
  127.0.0.1 frontend-app-1 frontend
  127.0.0.1 frontend-app-2 frontend
  127.0.0.1 backend-app-1 backend
  127.0.0.1 backend-app-2 backend
  127.0.0.1 development-1 development
  127.0.0.1 mongo-1 mongo
  127.0.0.1 mongo-2 mongo
  127.0.0.1 mongo-3 mongo
  127.0.0.1 logs-elasticsearch-1 elasticsearch
  127.0.0.1 logs-elasticsearch-2 elasticsearch

performanceplatform::mongo::mongo_hosts:
  - 127.0.0.1

python::version:    '2.7'
python::dev:        true
python::virtualenv: true
python::pip:        true

ufw_rules:
  allow-http-from-anywhere:
    port: 80
    ip:   'any'
  allow-https-from-anywhere:
    port: 443
    ip:   'any'
  spotlight-node-debug:
    port: 8080
    ip:   'any'

vhost_proxies:
  # For spotlight
  spotlight:
    servername:    "%{::spotlight_vhost}"
    upstream_port: 3057
  # For backdrop
  backdrop_read:
    servername:    "read.backdrop"
    upstream_port: 3038
  backdrop_write:
    servername:    "write.backdrop"
    upstream_port: 3039
  backdrop_admin:
    servername:    "admin.backdrop"
    upstream_port: 3203
  # For varnish
  www:
    servername:    "%{::www_vhost}"
    upstream_port: 7999
  admin:
    servername:    "%{::admin_vhost}"
    upstream_port: 7999
  assets:
    servername:    "%{::assets_vhost}"
    upstream_port: 7999

system_packages:
  - libcairo2-dev
  - libjpeg8-dev
  - libpango1.0-dev
  - libgif-dev
