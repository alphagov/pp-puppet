---
classes:
  - 'backdrop_collector'
  - 'clamav'
  - 'google_credentials'
  - 'performanceplatform::checks::backdrop'
  - 'performanceplatform::checks::stagecraft'
  - 'performanceplatform::backdrop_smoke_tests'
  - 'performanceplatform::pip'
  - 'python'
  - 'postgresql::lib::devel'

gunicorn_apps:
  admin.backdrop:
    port:       3203
    # This is a placeholder until we extract a separate app
    app_module: 'backdrop.admin.app:app'
    user:       'deploy'
    group:      'deploy'
  read.backdrop:
    port:       3038
    app_module: 'backdrop.read.api:app'
    user:       'deploy'
    group:      'deploy'
  write.backdrop:
    port:                 3039
    app_module:           'backdrop.write.api:app'
    user:                 'deploy'
    group:                'deploy'
    client_max_body_size: '30m'
    timeout:              60
  stagecraft:
    port:            3204
    app_module:      'stagecraft.wsgi:application'
    user:            'deploy'
    group:           'deploy'
    is_django:       true
    timeout:         2

backdrop_collectors:
  backdrop-ga-collector:
    user: 'deploy'
    group: 'deploy'
  backdrop-ga-realtime-collector:
    user: 'deploy'
    group: 'deploy'
  backdrop-ga-trending-collector:
    user: 'deploy'
    group: 'deploy'
  backdrop-pingdom-collector:
    user: 'deploy'
    group: 'deploy'

python::version:    '2.7'
python::dev:        true
python::virtualenv: true
python::pip:        true

performanceplatform::pip::user: 'deploy'
performanceplatform::pip::group: 'deploy'
performanceplatform::pip::pip_cache_path: '/var/cache/pip-download-cache'

ufw_rules:
  allowhttp:
    port: 80
    ip:   'any'

ruby_packages:
  - curb
  - json
