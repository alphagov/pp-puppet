classes:
  - 'java7'
  - 'python'
  - 'graphite'
  - 'logstash'
  - 'nginx'
  - 'performanceplatform::monitoring'
  - 'performanceplatform::pp_nginx'
  - 'rabbitmq'
  - 'redis'
  - 'performanceplatform::checks::servers'
  - 'performanceplatform::checks::smokey_tests'
  - 'performanceplatform::checks::ssl'
  - 'performanceplatform::checks::elasticsearch_log_errors'

nginx::confd_purge: true
nginx::vhost_purge: true

performanceplatform::checks::servers::boxes:
  - backend-app-1
  - backend-app-2
  - backup-box-1
  - frontend-app-1
  - frontend-app-2
  - jumpbox-1
  - mongo-1
  - mongo-2
  - mongo-3
  - monitoring-1
  - logs-elasticsearch-1
  - logs-elasticsearch-2
  - postgresql-primary-1

collectd::plugin::processes::process_matches:
  - name: 'logstash'
    regex: 'logstash.jar'

graphite::gr_apache_port:       9080
graphite::gr_apache_port_https: 9443
graphite::gr_storage_schemas:
  -
    name: "carbon"
    pattern: '^carbon\.'
    retentions: "1m:90d"
  -
    name: default
    retentions: "1s:30m,1m:1d,5m:100d"
    pattern: ".*"

sensu::dashboard_user:     "%{::basic_auth_username}"
sensu::dashboard_password: "%{::basic_auth_password}"
sensu::dashboard_port: 8090
sensu::server: true

logstash::java_install: true
logstash::provider: 'custom'
logstash::jarfile: 'puppet:///modules/performanceplatform/logstash-1.1.13-monolithic.jar'
logstash::instances:
    - 'agent-1'
    - 'agent-2'
logstash::defaultsfiles:
    'agent-1': 'puppet:///modules/performanceplatform/etc/sysconfig/logstash.dev.defaults'
    'agent-2': 'puppet:///modules/performanceplatform/etc/sysconfig/logstash.dev.defaults'

ufw_rules:
  allowcarbonfromanywhere:
    port: 2003
    ip:   'any'
  allowlumberjack1fromanywhere:
    port: 3456
    ip:   'any'
  allowlumberjack2fromanywhere:
    port: 3457
    ip:   'any'
  allowhttpfromall:
    port: 80
    ip:   'any'
  allowhttpsfromall:
    port: 443
    ip:   'any'
  allowrabbitmqfromall:
    port: 5672
    ip:   'any'
  allowsyslogfromanywhere:
    port: 514
    ip:   'any'
  allowredisfromfrontend1:
    port: 6379
    from:   '172.27.1.11'
    ip: 'any'
  allowredisfromfrontend2:
    port: 6379
    from:   '172.27.1.12'
    ip: 'any'

vhost_proxies:
  graphite-vhost:
    servername:      "graphite"
    ssl:             false
    upstream_server: 'localhost'
    upstream_port:   9080
    sensu_check:     false
    auth_basic: "Enter username/password"
    auth_basic_user_file: /etc/nginx/htpasswd
  alerts-vhost:
    servername:      "%{::alerts_vhost}"
    ssl:             false
    upstream_server: 'localhost'
    upstream_port:   8090
    sensu_check:     false

lumberjack_instances:
  nginx:
    log_files: [ '/var/log/nginx/*.access.log.json' ]

ruby_packages:
  - redphone
  - redis
